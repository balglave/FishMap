---
title: "Verify model reproducibility"
author: "swann floc'hlay"
date: '2023-03-09'
output: html_document
---



# Checking reproducibility of FishMap results

 <!-- this vignette is generated from dev/dev_check_model_reproducibility.Rmd, make your edit on this original file -->

This notebook gather the analysis performed in order to compare the output of the original FishMap `main.R` script between Client and ThinkR. We will compare the results obtained with identical seeds following the execution of the script `dev/run_main_and_save_output.R`.

## Executing `main.R`

We generate the outputs on ThinkR machine.
> make sure your .Renviron variables `FISHMAP_UPDATE_OUTPUTS` and `FISHMAP_OUTPUT_DIR` are correctly set


```r
# Generate results (model files are compiled)
source(here::here("dev", "run_main_and_save_output.R"))
```

```
## Step 1 -loading data-: 18.914 sec elapsed
## Step 2 -compile model-: 73 sec elapsed
##   0:     36231.535:  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  1.00000  1.00000  0.00000  0.00000  1.00000
##   1:     34620.699: -0.000611263 0.0111047 -0.0156403 0.0102825 0.124038 0.170300 0.107928 0.219166 0.254485 0.984779  1.02404 0.00480612 0.00127533  1.00142
##   2:     34468.939: -0.00311577 0.0603602 -0.0857435 -0.0222451 0.208401 0.331487 0.292156 0.0501506 0.0135788 0.943944  1.10149 0.0240668 0.00653019  1.00723
##   3:     33982.291: -0.00699680 0.128341 -0.184046 -0.0766144 0.374464 0.603974 0.131266 0.113838 0.101948 0.842542  1.14889 0.0497129 0.0137662  1.01562
##   4:     33810.021: -0.0154823 0.261197 -0.383417 0.0764999 0.493458 0.618758 0.133829 0.0569172 -0.0430482 0.632082  1.08769 0.0951398 0.0275287  1.03258
##   5:     33729.552: -0.0164510 0.276589 -0.407765 0.0514200 0.505881 0.652014 0.156276 0.0145354 0.0575309 0.659175  1.08274 0.100509 0.0293550  1.03485
##   6:     33686.940: -0.0191766 0.318496 -0.474206 0.00893454 0.549691 0.617556 0.168675 0.0248413 -0.00151819 0.682039  1.06548 0.114979 0.0343887  1.04119
##   7:     33638.958: -0.0227585 0.371712 -0.559775 -0.00605338 0.532240 0.625772 0.176094 -0.00423238 0.0426364 0.641538  1.05089 0.133499 0.0412104  1.04991
##   8:     33620.032: -0.0261337 0.418411 -0.640393 -0.0342850 0.530637 0.608663 0.190487 0.0649055 0.0254458 0.629140  1.03516 0.151114 0.0487885  1.05974
##   9:     33583.491: -0.0296476 0.466499 -0.724333 -0.0438316 0.526986 0.616835 0.176766 -0.00160644 0.00236307 0.616259  1.01214 0.170230 0.0571068  1.07045
##  10:     33567.300: -0.0303451 0.475466 -0.740533 -0.0474712 0.543779 0.633865 0.185195 0.0289533 0.0438028 0.617156  1.00937 0.174022 0.0588620  1.07273
##  11:     33551.884: -0.0322315 0.496623 -0.783106 -0.0470869 0.548051 0.625279 0.190934 0.0119093 0.0189748 0.620048 0.995482 0.184162 0.0643544  1.07994
##  12:     33541.057: -0.0342130 0.517556 -0.826890 -0.0592820 0.547664 0.638322 0.183568 0.0225153 0.0423825 0.612723 0.990476 0.194633 0.0704097  1.08794
##  13:     33528.834: -0.0363021 0.536812 -0.871073 -0.0604765 0.541815 0.629576 0.193767 0.0194579 0.0151104 0.602361 0.985144 0.205331 0.0773888  1.09723
##  14:     33519.168: -0.0384477 0.552458 -0.914393 -0.0659811 0.550695 0.635143 0.193089 0.00997024 0.0422614 0.615365 0.974737 0.216080 0.0857430  1.10843
##  15:     33509.846: -0.0407163 0.568351 -0.959088 -0.0687796 0.558711 0.632886 0.186068 0.0271709 0.0198829 0.603188 0.971821 0.226922 0.0947787  1.12057
##  16:     33502.083: -0.0429815 0.578676 -1.00012 -0.0665735 0.535914 0.634885 0.205201 0.00950489 0.0328800 0.592881 0.972014 0.236688 0.105213  1.13471
##  17:     33493.520: -0.0452376 0.585728 -1.03957 -0.0882358 0.549713 0.639364 0.185023 0.0166912 0.0251598 0.612600 0.971261 0.245905 0.117084  1.15076
##  18:     33487.994: -0.0471415 0.600190 -1.07719 -0.0688601 0.553780 0.637511 0.214288 0.0170128 0.0295670 0.590455 0.963771 0.254301 0.124793  1.16104
##  19:     33480.739: -0.0494881 0.606979 -1.11736 -0.0785503 0.556318 0.629804 0.179710 0.00974230 0.0278094 0.588749 0.957460 0.262852 0.138020  1.17879
##  20:     33474.263: -0.0519570 0.612911 -1.15736 -0.0813324 0.551730 0.647238 0.204749 0.0224565 0.0256494 0.605509 0.958260 0.270745 0.152337  1.19792
##  21:     33472.105: -0.0545821 0.613891 -1.19624 -0.0907478 0.541919 0.636643 0.196735 -0.00361663 0.0247866 0.592207 0.965429 0.277726 0.169802  1.22112
##  22:     33465.711: -0.0569968 0.615873 -1.23230 -0.0864680 0.563252 0.624284 0.187534 0.0205426 0.0330845 0.575822 0.963280 0.284163 0.185693  1.24213
##  23:     33461.588: -0.0591968 0.612596 -1.26176 -0.0680949 0.567658 0.630247 0.196047 0.00330718 0.0254294 0.601226 0.941321 0.287887 0.203347  1.26504
##  24:     33457.265: -0.0613984 0.613760 -1.29411 -0.0826166 0.545476 0.657021 0.195647 0.0201496 0.0299338 0.592629 0.950954 0.292273 0.219800  1.28621
##  25:     33455.112: -0.0638411 0.612770 -1.32821 -0.0976103 0.549692 0.633063 0.199143 0.00917653 0.0106782 0.585262 0.962883 0.296877 0.239010  1.31082
##  26:     33450.162: -0.0662130 0.611947 -1.36089 -0.0966840 0.572320 0.623438 0.196624 0.00623256 0.0390277 0.572211 0.965236 0.300944 0.258558  1.33549
##  27:     33446.244: -0.0683495 0.611843 -1.39041 -0.0806185 0.556850 0.633802 0.192643 0.0152277 0.0218311 0.591302 0.941839 0.304123 0.277352  1.35858
##  28:     33446.066: -0.0709831 0.608455 -1.42318 -0.0896153 0.550049 0.654254 0.206963 0.00200116 0.0348572 0.590870 0.949390 0.306816 0.301269  1.38787
##  29:     33441.307: -0.0719101 0.607491 -1.43465 -0.0935515 0.558646 0.646101 0.201915 0.0157816 0.0199124 0.586969 0.952276 0.307867 0.309482  1.39790
##  30:     33439.669: -0.0733362 0.608765 -1.45429 -0.0924653 0.558604 0.642584 0.196732 0.00762463 0.0277530 0.582821 0.949920 0.310385 0.321082  1.41200
##  31:     33438.084: -0.0748115 0.606517 -1.47068 -0.0953221 0.562567 0.635865 0.202746 0.0140195 0.0241471 0.581540 0.954071 0.311477 0.334958  1.42853
##  32:     33436.743: -0.0764086 0.603015 -1.48655 -0.0983562 0.562545 0.641348 0.200382 0.00738585 0.0277208 0.582450 0.955860 0.312034 0.350082  1.44639
##  33:     33435.363: -0.0779813 0.599834 -1.50194 -0.0940494 0.561115 0.642252 0.197865 0.0145157 0.0217946 0.581635 0.950363 0.312795 0.365026  1.46378
##  34:     33434.164: -0.0795491 0.597046 -1.51670 -0.0946204 0.557069 0.638739 0.203867 0.00915478 0.0283104 0.582174 0.950678 0.313440 0.380615  1.48145
##  35:     33432.896: -0.0811394 0.593365 -1.53029 -0.0972105 0.565670 0.640199 0.200618 0.0127109 0.0234597 0.583870 0.953931 0.313553 0.396601  1.49937
##  36:     33431.781: -0.0827963 0.590587 -1.54558 -0.0942867 0.561350 0.643533 0.198687 0.00727471 0.0267462 0.580729 0.951335 0.314371 0.412644  1.51724
##  37:     33430.726: -0.0844115 0.587591 -1.55869 -0.0961397 0.557642 0.636866 0.202154 0.0159436 0.0242706 0.581130 0.951965 0.314710 0.428988  1.53496
##  38:     33429.657: -0.0861081 0.583315 -1.57014 -0.0978335 0.563002 0.640960 0.202878 0.00775508 0.0263837 0.584701 0.952558 0.314215 0.446221  1.55334
##  39:     33428.707: -0.0878513 0.579241 -1.58248 -0.0938992 0.565811 0.642957 0.198006 0.0142107 0.0236579 0.581413 0.949825 0.314244 0.463467  1.57158
##  40:     33427.723: -0.0896252 0.576560 -1.59619 -0.0944415 0.558800 0.639666 0.200458 0.00853952 0.0246172 0.580702 0.952347 0.314797 0.480575  1.58955
##  41:     33427.030: -0.0914521 0.572943 -1.60688 -0.0979362 0.559452 0.639612 0.203080 0.0168202 0.0292618 0.585722 0.954732 0.314366 0.498464  1.60768
##  42:     33426.145: -0.0932647 0.567957 -1.61678 -0.0973674 0.565575 0.640581 0.202557 0.0104064 0.0201326 0.583131 0.951228 0.313801 0.515732  1.62539
##  43:     33425.425: -0.0951859 0.564311 -1.62750 -0.0940310 0.561981 0.643447 0.197185 0.00906740 0.0297558 0.581938 0.947205 0.313717 0.533314  1.64288
##  44:     33424.398: -0.0971560 0.560307 -1.63929 -0.0927862 0.563275 0.640798 0.200265 0.0141452 0.0238508 0.581365 0.952872 0.313738 0.551233  1.66099
##  45:     33423.739: -0.0993266 0.557064 -1.65041 -0.0962762 0.558740 0.642044 0.201113 0.00775327 0.0261325 0.587170 0.952794 0.313505 0.569674  1.67906
##  46:     33422.780: -0.101521 0.551927 -1.66034 -0.0974160 0.564511 0.642811 0.201105 0.0130812 0.0264047 0.582471 0.947582 0.312895 0.588109  1.69743
##  47:     33422.145: -0.103777 0.551047 -1.67510 -0.0913425 0.560491 0.639067 0.198672 0.00840824 0.0232250 0.583694 0.953805 0.314117 0.604731  1.71398
##  48:     33421.348: -0.106260 0.545913 -1.68653 -0.0906986 0.564049 0.643855 0.200561 0.0109637 0.0272766 0.583242 0.957734 0.313845 0.622971  1.73259
##  49:     33420.840: -0.108545 0.543701 -1.69470 -0.100743 0.560247 0.641959 0.199641 0.0137350 0.0213189 0.586009 0.940699 0.313402 0.636736  1.74649
##  50:     33420.094: -0.111344 0.538954 -1.70547 -0.101988 0.562307 0.643547 0.204202 0.00809373 0.0270126 0.579514 0.936470 0.312949 0.653871  1.76456
##  51:     33419.447: -0.113361 0.540319 -1.71880 -0.0918492 0.562510 0.640861 0.199294 0.0132629 0.0242906 0.585166 0.954212 0.315056 0.663935  1.77534
##  52:     33418.944: -0.116658 0.536606 -1.73264 -0.0892351 0.562223 0.643959 0.198691 0.00740873 0.0251719 0.587547 0.959950 0.315741 0.680485  1.79376
##  53:     33418.246: -0.119592 0.530727 -1.73904 -0.0986615 0.563663 0.643182 0.201469 0.0119969 0.0243635 0.581334 0.944902 0.314345 0.694415  1.80971
##  54:     33417.940: -0.123237 0.531664 -1.75586 -0.0953071 0.560798 0.641609 0.204811 0.00601897 0.0275211 0.583531 0.939138 0.316423 0.708921  1.82680
##  55:     33416.925: -0.127372 0.528130 -1.76925 -0.0931468 0.560193 0.641963 0.199481 0.0131407 0.0256051 0.585661 0.946656 0.317466 0.723584  1.84540
##  56:     33416.886: -0.130928 0.524581 -1.78327 -0.0992058 0.564137 0.646786 0.206346 0.00609689 0.0184910 0.581290 0.945937 0.317624 0.736308  1.86256
##  57:     33416.140: -0.132769 0.523927 -1.78985 -0.0994944 0.564880 0.647348 0.202570 0.0115819 0.0256141 0.580964 0.946711 0.317958 0.741700  1.87011
##  58:     33415.804: -0.134945 0.523665 -1.79749 -0.0958054 0.564374 0.642907 0.201325 0.00940610 0.0231512 0.582949 0.948056 0.318748 0.747957  1.87880
##  59:     33415.517: -0.137368 0.522196 -1.80467 -0.0944678 0.562573 0.644304 0.201124 0.0116503 0.0262963 0.584372 0.949349 0.319441 0.754867  1.88863
##  60:     33415.271: -0.139899 0.519224 -1.81061 -0.0962206 0.561292 0.644512 0.201037 0.0108777 0.0227704 0.584072 0.948046 0.319665 0.761989  1.89909
##  61:     33415.004: -0.142759 0.516815 -1.81693 -0.0951407 0.564129 0.644672 0.200769 0.0113526 0.0256256 0.584185 0.947601 0.319990 0.768758  1.90968
##  62:     33414.761: -0.145583 0.515049 -1.82416 -0.0952283 0.562629 0.643008 0.201465 0.0100381 0.0234220 0.583748 0.948746 0.320406 0.775272  1.92020
##  63:     33414.542: -0.148467 0.511965 -1.82989 -0.0966932 0.561659 0.645144 0.201337 0.0119625 0.0256178 0.583234 0.948271 0.320627 0.781899  1.93110
##  64:     33414.321: -0.151656 0.509414 -1.83511 -0.0928180 0.563974 0.645369 0.200396 0.0108259 0.0224878 0.586048 0.947658 0.321388 0.787751  1.94162
##  65:     33414.087: -0.154774 0.507785 -1.84227 -0.0940196 0.563209 0.644708 0.200722 0.0103866 0.0258523 0.584381 0.948485 0.321924 0.793627  1.95230
##  66:     33413.911: -0.158008 0.504663 -1.84747 -0.0971528 0.562977 0.642646 0.201660 0.0112429 0.0229041 0.582514 0.948161 0.321573 0.799372  1.96333
##  67:     33413.691: -0.161688 0.501568 -1.85234 -0.0948430 0.562754 0.645631 0.201120 0.0110865 0.0247342 0.584865 0.948221 0.321911 0.804854  1.97472
##  68:     33413.503: -0.165417 0.499740 -1.85893 -0.0928463 0.563593 0.644413 0.200530 0.0114878 0.0219080 0.585195 0.948181 0.323724 0.810042  1.98588
##  69:     33413.285: -0.169182 0.497478 -1.86507 -0.0953892 0.563411 0.643669 0.200755 0.00992332 0.0248764 0.583550 0.948318 0.323852 0.814984  1.99717
##  70:     33413.157: -0.173318 0.495110 -1.87062 -0.0946343 0.564129 0.643768 0.202113 0.0136597 0.0233621 0.584121 0.948612 0.322239 0.819335  2.00881
##  71:     33412.928: -0.177324 0.492488 -1.87632 -0.0952845 0.561721 0.645344 0.201629 0.0108746 0.0227674 0.584855 0.948247 0.322830 0.824147  2.02036
##  72:     33412.795: -0.181476 0.490022 -1.88127 -0.0941248 0.564960 0.645171 0.200295 0.0128726 0.0257810 0.583956 0.947573 0.327220 0.828311  2.03121
##  73:     33412.558: -0.185833 0.488140 -1.88761 -0.0943894 0.564605 0.643149 0.200898 0.0110842 0.0233761 0.584142 0.948491 0.327907 0.832476  2.04284
##  74:     33412.400: -0.189970 0.486604 -1.89395 -0.0932749 0.563034 0.645398 0.201533 0.0119533 0.0254991 0.584680 0.948786 0.323844 0.836022  2.05408
##  75:     33412.214: -0.194303 0.483910 -1.89955 -0.0948246 0.563164 0.645467 0.201007 0.0121374 0.0229168 0.584269 0.947347 0.325731 0.840468  2.06582
##  76:     33412.057: -0.198639 0.482025 -1.90485 -0.0944735 0.564092 0.644324 0.201183 0.0107880 0.0255582 0.584678 0.948446 0.332215 0.844191  2.07637
##  77:     33411.898: -0.202970 0.480550 -1.91139 -0.0935179 0.564123 0.643485 0.201164 0.0120419 0.0238071 0.584552 0.949245 0.327805 0.847357  2.08777
##  78:     33411.758: -0.207432 0.477699 -1.91660 -0.0937191 0.563467 0.645903 0.200924 0.0110210 0.0248340 0.583905 0.947457 0.324993 0.850959  2.09969
##  79:     33411.625: -0.211572 0.474948 -1.92007 -0.0940163 0.563539 0.645481 0.201289 0.0120240 0.0232885 0.585045 0.947709 0.333902 0.854456  2.10952
##  80:     33411.489: -0.216398 0.473901 -1.92676 -0.0936233 0.563573 0.644260 0.200940 0.0107409 0.0254659 0.585351 0.949349 0.331144 0.856934  2.12119
##  81:     33411.368: -0.220938 0.471915 -1.93220 -0.0937422 0.564465 0.643806 0.200820 0.0119596 0.0238298 0.584004 0.948561 0.325457 0.859264  2.13261
##  82:     33411.250: -0.225535 0.468334 -1.93499 -0.0933649 0.563413 0.645777 0.201183 0.0110298 0.0245573 0.583929 0.947693 0.332978 0.862398  2.14332
##  83:     33411.126: -0.231128 0.466647 -1.94052 -0.0931201 0.564005 0.645109 0.200969 0.0121223 0.0232511 0.586134 0.948886 0.333388 0.864298  2.15563
##  84:     33411.009: -0.236452 0.464823 -1.94576 -0.0935760 0.564016 0.644875 0.200702 0.0109211 0.0249502 0.585166 0.948753 0.329335 0.865918  2.16772
##  85:     33410.910: -0.241749 0.461537 -1.94905 -0.0932443 0.563871 0.644429 0.201025 0.0119870 0.0233517 0.583465 0.947984 0.334838 0.868387  2.17941
##  86:     33410.523: -0.279468 0.448068 -1.97290 -0.0898310 0.563367 0.646238 0.200741 0.0149852 0.0252612 0.589257 0.956212 0.332807 0.872562  2.25468
##  87:     33410.063: -0.321145 0.432104 -1.98594 -0.0850476 0.566316 0.644337 0.196629 0.00845322 0.0244359 0.589584 0.954393 0.341249 0.870793  2.32987
##  88:     33409.867: -0.365557 0.425585 -1.99420 -0.103742 0.565831 0.642854 0.202227 0.0108960 0.0270830 0.577494 0.931994 0.359011 0.859726  2.39639
##  89:     33409.764: -0.415977 0.435233 -2.01156 -0.0989621 0.562959 0.640655 0.208719 0.0120761 0.0215660 0.580853 0.936365 0.346932 0.831181  2.45925
##  90:     33409.128: -0.465992 0.438348 -2.02826 -0.0896046 0.565948 0.647408 0.201611 0.0120632 0.0238730 0.581453 0.950134 0.371791 0.811031  2.52079
##  91:     33409.066: -0.466059 0.438577 -2.02892 -0.0911732 0.565463 0.646218 0.200041 0.00868171 0.0225309 0.584574 0.949425 0.371711 0.811247  2.52107
##  92:     33409.006: -0.468161 0.438087 -2.02990 -0.0909369 0.566072 0.646392 0.200252 0.0114764 0.0240113 0.584973 0.949218 0.370257 0.812047  2.52448
##  93:     33408.974: -0.470743 0.437187 -2.03079 -0.0907168 0.565420 0.645976 0.200272 0.0105037 0.0235737 0.585387 0.949194 0.368955 0.813237  2.52864
##  94:     33408.953: -0.473173 0.436678 -2.03247 -0.0905881 0.564901 0.645892 0.200380 0.0117193 0.0240240 0.585779 0.949101 0.367877 0.814548  2.53272
##  95:     33408.929: -0.475882 0.435749 -2.03347 -0.0905977 0.564666 0.645701 0.200261 0.0107780 0.0236356 0.585975 0.949232 0.366766 0.815626  2.53695
##  96:     33408.781: -0.523281 0.417010 -2.04532 -0.0900354 0.568743 0.644871 0.199067 0.0107565 0.0234362 0.586810 0.953304 0.352092 0.831168  2.60830
##  97:     33408.596: -0.574765 0.397656 -2.05336 -0.0846316 0.564957 0.643929 0.200117 0.00984478 0.0255994 0.589168 0.958682 0.362850 0.841883  2.67841
##  98:     33408.387: -0.634570 0.398869 -2.07006 -0.0818250 0.564183 0.647226 0.198470 0.0120080 0.0218985 0.591845 0.957664 0.377272 0.817880  2.73867
##  99:     33408.232: -0.691087 0.416478 -2.08958 -0.0866218 0.562603 0.646089 0.198238 0.0119282 0.0245659 0.590874 0.955901 0.376374 0.770714  2.78529
## 100:     33408.109: -0.746843 0.408664 -2.09374 -0.0881175 0.564144 0.644890 0.199875 0.0116913 0.0244095 0.589823 0.959823 0.388586 0.774097  2.85564
## 101:     33407.999: -0.801262 0.397869 -2.09712 -0.0849576 0.563792 0.646255 0.198623 0.00980916 0.0223194 0.588517 0.954045 0.386939 0.779569  2.92735
## 102:     33407.921: -0.853956 0.380645 -2.10177 -0.0840618 0.565168 0.647478 0.199094 0.0120657 0.0241827 0.590139 0.952168 0.387346 0.782710  2.99944
## 103:     33407.797: -0.958365 0.329875 -2.13572 -0.0828371 0.563580 0.645504 0.198378 0.0126774 0.0238708 0.591165 0.955161 0.395116 0.725148  3.14344
## 104:     33407.691: -1.06982 0.342508 -2.14144 -0.0845981 0.563317 0.648818 0.199856 0.0104880 0.0225216 0.590481 0.952771 0.409054 0.684808  3.29931
## 105:     33407.632: -1.10899 0.383616 -2.12927 -0.0831484 0.564241 0.645439 0.197984 0.0111160 0.0235974 0.591065 0.955477 0.416828 0.684066  3.36342
## 106:     33407.629: -1.11564 0.381681 -2.13128 -0.0855768 0.563851 0.646878 0.198523 0.0120175 0.0240090 0.589092 0.955656 0.415896 0.680618  3.37952
## 107:     33407.609: -1.12094 0.373909 -2.13692 -0.0859258 0.564152 0.646457 0.198822 0.0111968 0.0235075 0.589286 0.955134 0.418227 0.673443  3.39210
## 108:     33407.603: -1.12628 0.366992 -2.14181 -0.0859431 0.564593 0.646093 0.199098 0.0112941 0.0237020 0.589510 0.954736 0.420419 0.666796  3.40578
## 109:     33407.593: -1.14356 0.359621 -2.14304 -0.0862770 0.564313 0.645861 0.198930 0.0113389 0.0237471 0.589811 0.954505 0.423697 0.666087  3.45626
## 110:     33407.582: -1.16040 0.355076 -2.14883 -0.0857569 0.564396 0.645701 0.199056 0.0110598 0.0236932 0.589247 0.954825 0.425825 0.652038  3.50498
## 111:     33407.574: -1.17057 0.348187 -2.15488 -0.0862768 0.564348 0.645903 0.198953 0.0110882 0.0236419 0.589068 0.954580 0.430629 0.628407  3.55130
## 112:     33407.570: -1.18173 0.348596 -2.15689 -0.0862939 0.564231 0.645969 0.199092 0.0113201 0.0234617 0.589317 0.954467 0.431976 0.616106  3.60260
## 113:     33407.567: -1.18777 0.340774 -2.16311 -0.0856399 0.564152 0.645981 0.198977 0.0112180 0.0237809 0.589783 0.955244 0.436061 0.603916  3.65370
## 114:     33407.566: -1.18605 0.336144 -2.16587 -0.0859506 0.564453 0.646021 0.198927 0.0111617 0.0237165 0.589368 0.954806 0.436809 0.597770  3.67534
## 115:     33407.566: -1.18342 0.338242 -2.16421 -0.0859896 0.564207 0.646037 0.198935 0.0112399 0.0236176 0.589434 0.954886 0.438728 0.589822  3.69675
## 116:     33407.566: -1.18066 0.337686 -2.16519 -0.0860470 0.564253 0.646033 0.198956 0.0112283 0.0236450 0.589414 0.954833 0.438146 0.592672  3.69202
## 117:     33407.566: -1.17997 0.338183 -2.16452 -0.0859890 0.564292 0.646026 0.198945 0.0112172 0.0236574 0.589431 0.954853 0.438127 0.592037  3.69260
## 118:     33407.566: -1.17949 0.337930 -2.16479 -0.0859945 0.564271 0.646033 0.198943 0.0112249 0.0236473 0.589429 0.954853 0.438195 0.592209  3.69255
## Warning: 4 external pointers will be removed
## Step 3 -fit model-: 75.594 sec elapsed
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2-1.png)

```
## Step 4 -plot graphs-: 0.615 sec elapsed
## run main.R: 177.199 sec elapsed
```

> Note: model fit is perfomed in 118 steps in this run

Executing this code results in four outputs to be compared.


```r
output_dir <- Sys.getenv("FISHMAP_OUTPUT_DIR")
list.files(path = file.path(output_dir))
```

```
## [1] "converge_output.rds" "obj_input.rds"       "opt_output.rds"      "report_output.rds"
```


To check whether the seed is effectively making the output reproducible, we will run a second time `main.R` with the same seed.


```r
# Create a temporary folder
tmp_folder <- tempfile(pattern = "fishmap_check")
dir.create(tmp_folder)

# Move ThinkR first execution output in temp folder
dir.create(file.path(tmp_folder, "thinkr_output"))
fs::file_move(
  path = list.files(
    path = output_dir,
    full.names = TRUE
  ),
  new_path = file.path(tmp_folder, "thinkr_output")
)

# Run main.R a second time (model files are already compiled from first run)
source(here::here("dev", "run_main_and_save_output.R"))
```

```
## Step 1 -loading data-: 18.481 sec elapsed
## Step 2 -compile model-: 0.04 sec elapsed
##   0:     36231.535:  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  1.00000  1.00000  0.00000  0.00000  1.00000
##   1:     34620.699: -0.000611263 0.0111047 -0.0156403 0.0102825 0.124038 0.170300 0.107928 0.219166 0.254485 0.984779  1.02404 0.00480612 0.00127533  1.00142
##   2:     34468.939: -0.00311577 0.0603602 -0.0857435 -0.0222451 0.208401 0.331487 0.292156 0.0501506 0.0135788 0.943944  1.10149 0.0240668 0.00653019  1.00723
##   3:     33982.291: -0.00699680 0.128341 -0.184046 -0.0766144 0.374464 0.603974 0.131266 0.113838 0.101948 0.842542  1.14889 0.0497129 0.0137662  1.01562
##   4:     33810.021: -0.0154823 0.261197 -0.383417 0.0764999 0.493458 0.618758 0.133829 0.0569172 -0.0430482 0.632082  1.08769 0.0951398 0.0275287  1.03258
##   5:     33729.552: -0.0164510 0.276589 -0.407765 0.0514200 0.505881 0.652014 0.156276 0.0145354 0.0575309 0.659175  1.08274 0.100509 0.0293550  1.03485
##   6:     33686.940: -0.0191766 0.318496 -0.474206 0.00893454 0.549691 0.617556 0.168675 0.0248413 -0.00151819 0.682039  1.06548 0.114979 0.0343887  1.04119
##   7:     33638.958: -0.0227585 0.371712 -0.559775 -0.00605338 0.532240 0.625772 0.176094 -0.00423238 0.0426364 0.641538  1.05089 0.133499 0.0412104  1.04991
##   8:     33620.032: -0.0261337 0.418411 -0.640393 -0.0342850 0.530637 0.608663 0.190487 0.0649055 0.0254458 0.629140  1.03516 0.151114 0.0487885  1.05974
##   9:     33583.491: -0.0296476 0.466499 -0.724333 -0.0438316 0.526986 0.616835 0.176766 -0.00160644 0.00236307 0.616259  1.01214 0.170230 0.0571068  1.07045
##  10:     33567.300: -0.0303451 0.475466 -0.740533 -0.0474712 0.543779 0.633865 0.185195 0.0289533 0.0438028 0.617156  1.00937 0.174022 0.0588620  1.07273
##  11:     33551.884: -0.0322315 0.496623 -0.783106 -0.0470869 0.548051 0.625279 0.190934 0.0119093 0.0189748 0.620048 0.995482 0.184162 0.0643544  1.07994
##  12:     33541.057: -0.0342130 0.517556 -0.826890 -0.0592820 0.547664 0.638322 0.183568 0.0225153 0.0423825 0.612723 0.990476 0.194633 0.0704097  1.08794
##  13:     33528.834: -0.0363021 0.536812 -0.871073 -0.0604765 0.541815 0.629576 0.193767 0.0194579 0.0151104 0.602361 0.985144 0.205331 0.0773888  1.09723
##  14:     33519.168: -0.0384477 0.552458 -0.914393 -0.0659811 0.550695 0.635143 0.193089 0.00997024 0.0422614 0.615365 0.974737 0.216080 0.0857430  1.10843
##  15:     33509.846: -0.0407163 0.568351 -0.959088 -0.0687796 0.558711 0.632886 0.186068 0.0271709 0.0198829 0.603188 0.971821 0.226922 0.0947787  1.12057
##  16:     33502.083: -0.0429815 0.578676 -1.00012 -0.0665735 0.535914 0.634885 0.205201 0.00950489 0.0328800 0.592881 0.972014 0.236688 0.105213  1.13471
##  17:     33493.520: -0.0452376 0.585728 -1.03957 -0.0882358 0.549713 0.639364 0.185023 0.0166912 0.0251598 0.612600 0.971261 0.245905 0.117084  1.15076
##  18:     33487.994: -0.0471415 0.600190 -1.07719 -0.0688601 0.553780 0.637511 0.214288 0.0170128 0.0295670 0.590455 0.963771 0.254301 0.124793  1.16104
##  19:     33480.739: -0.0494881 0.606979 -1.11736 -0.0785503 0.556318 0.629804 0.179710 0.00974230 0.0278094 0.588749 0.957460 0.262852 0.138020  1.17879
##  20:     33474.263: -0.0519570 0.612911 -1.15736 -0.0813324 0.551730 0.647238 0.204749 0.0224565 0.0256494 0.605509 0.958260 0.270745 0.152337  1.19792
##  21:     33472.105: -0.0545821 0.613891 -1.19624 -0.0907478 0.541919 0.636643 0.196735 -0.00361663 0.0247866 0.592207 0.965429 0.277726 0.169802  1.22112
##  22:     33465.711: -0.0569968 0.615873 -1.23230 -0.0864680 0.563252 0.624284 0.187534 0.0205426 0.0330845 0.575822 0.963280 0.284163 0.185693  1.24213
##  23:     33461.588: -0.0591968 0.612596 -1.26176 -0.0680949 0.567658 0.630247 0.196047 0.00330718 0.0254294 0.601226 0.941321 0.287887 0.203347  1.26504
##  24:     33457.265: -0.0613984 0.613760 -1.29411 -0.0826166 0.545476 0.657021 0.195647 0.0201496 0.0299338 0.592629 0.950954 0.292273 0.219800  1.28621
##  25:     33455.112: -0.0638411 0.612770 -1.32821 -0.0976103 0.549692 0.633063 0.199143 0.00917653 0.0106782 0.585262 0.962883 0.296877 0.239010  1.31082
##  26:     33450.162: -0.0662130 0.611947 -1.36089 -0.0966840 0.572320 0.623438 0.196624 0.00623256 0.0390277 0.572211 0.965236 0.300944 0.258558  1.33549
##  27:     33446.244: -0.0683495 0.611843 -1.39041 -0.0806185 0.556850 0.633802 0.192643 0.0152277 0.0218311 0.591302 0.941839 0.304123 0.277352  1.35858
##  28:     33446.066: -0.0709831 0.608455 -1.42318 -0.0896153 0.550049 0.654254 0.206963 0.00200116 0.0348572 0.590870 0.949390 0.306816 0.301269  1.38787
##  29:     33441.307: -0.0719101 0.607491 -1.43465 -0.0935515 0.558646 0.646101 0.201915 0.0157816 0.0199124 0.586969 0.952276 0.307867 0.309482  1.39790
##  30:     33439.669: -0.0733362 0.608765 -1.45429 -0.0924653 0.558604 0.642584 0.196732 0.00762463 0.0277530 0.582821 0.949920 0.310385 0.321082  1.41200
##  31:     33438.084: -0.0748115 0.606517 -1.47068 -0.0953221 0.562567 0.635865 0.202746 0.0140195 0.0241471 0.581540 0.954071 0.311477 0.334958  1.42853
##  32:     33436.743: -0.0764086 0.603015 -1.48655 -0.0983562 0.562545 0.641348 0.200382 0.00738585 0.0277208 0.582450 0.955860 0.312034 0.350082  1.44639
##  33:     33435.363: -0.0779813 0.599834 -1.50194 -0.0940494 0.561115 0.642252 0.197865 0.0145157 0.0217946 0.581635 0.950363 0.312795 0.365026  1.46378
##  34:     33434.164: -0.0795491 0.597046 -1.51670 -0.0946204 0.557069 0.638739 0.203867 0.00915478 0.0283104 0.582174 0.950678 0.313440 0.380615  1.48145
##  35:     33432.896: -0.0811394 0.593365 -1.53029 -0.0972105 0.565670 0.640199 0.200618 0.0127109 0.0234597 0.583870 0.953931 0.313553 0.396601  1.49937
##  36:     33431.781: -0.0827963 0.590587 -1.54558 -0.0942867 0.561350 0.643533 0.198687 0.00727471 0.0267462 0.580729 0.951335 0.314371 0.412644  1.51724
##  37:     33430.726: -0.0844115 0.587591 -1.55869 -0.0961397 0.557642 0.636866 0.202154 0.0159436 0.0242706 0.581130 0.951965 0.314710 0.428988  1.53496
##  38:     33429.657: -0.0861081 0.583315 -1.57014 -0.0978335 0.563002 0.640960 0.202878 0.00775508 0.0263837 0.584701 0.952558 0.314215 0.446221  1.55334
##  39:     33428.707: -0.0878513 0.579241 -1.58248 -0.0938992 0.565811 0.642957 0.198006 0.0142107 0.0236579 0.581413 0.949825 0.314244 0.463467  1.57158
##  40:     33427.723: -0.0896252 0.576560 -1.59619 -0.0944415 0.558800 0.639666 0.200458 0.00853952 0.0246172 0.580702 0.952347 0.314797 0.480575  1.58955
##  41:     33427.030: -0.0914521 0.572943 -1.60688 -0.0979362 0.559452 0.639612 0.203080 0.0168202 0.0292618 0.585722 0.954732 0.314366 0.498464  1.60768
##  42:     33426.145: -0.0932647 0.567957 -1.61678 -0.0973674 0.565575 0.640581 0.202557 0.0104064 0.0201326 0.583131 0.951228 0.313801 0.515732  1.62539
##  43:     33425.425: -0.0951859 0.564311 -1.62750 -0.0940310 0.561981 0.643447 0.197185 0.00906740 0.0297558 0.581938 0.947205 0.313717 0.533314  1.64288
##  44:     33424.398: -0.0971560 0.560307 -1.63929 -0.0927862 0.563275 0.640798 0.200265 0.0141452 0.0238508 0.581365 0.952872 0.313738 0.551233  1.66099
##  45:     33423.739: -0.0993266 0.557064 -1.65041 -0.0962762 0.558740 0.642044 0.201113 0.00775327 0.0261325 0.587170 0.952794 0.313505 0.569674  1.67906
##  46:     33422.780: -0.101521 0.551927 -1.66034 -0.0974160 0.564511 0.642811 0.201105 0.0130812 0.0264047 0.582471 0.947582 0.312895 0.588109  1.69743
##  47:     33422.145: -0.103777 0.551047 -1.67510 -0.0913425 0.560491 0.639067 0.198672 0.00840824 0.0232250 0.583694 0.953805 0.314117 0.604731  1.71398
##  48:     33421.348: -0.106260 0.545913 -1.68653 -0.0906986 0.564049 0.643855 0.200561 0.0109637 0.0272766 0.583242 0.957734 0.313845 0.622971  1.73259
##  49:     33420.840: -0.108545 0.543701 -1.69470 -0.100743 0.560247 0.641959 0.199641 0.0137350 0.0213189 0.586009 0.940699 0.313402 0.636736  1.74649
##  50:     33420.094: -0.111344 0.538954 -1.70547 -0.101988 0.562307 0.643547 0.204202 0.00809373 0.0270126 0.579514 0.936470 0.312949 0.653871  1.76456
##  51:     33419.447: -0.113361 0.540319 -1.71880 -0.0918492 0.562510 0.640861 0.199294 0.0132629 0.0242906 0.585166 0.954212 0.315056 0.663935  1.77534
##  52:     33418.944: -0.116658 0.536606 -1.73264 -0.0892351 0.562223 0.643959 0.198691 0.00740873 0.0251719 0.587547 0.959950 0.315741 0.680485  1.79376
##  53:     33418.246: -0.119592 0.530727 -1.73904 -0.0986615 0.563663 0.643182 0.201469 0.0119969 0.0243635 0.581334 0.944902 0.314345 0.694415  1.80971
##  54:     33417.940: -0.123237 0.531664 -1.75586 -0.0953071 0.560798 0.641609 0.204811 0.00601897 0.0275211 0.583531 0.939138 0.316423 0.708921  1.82680
##  55:     33416.925: -0.127372 0.528130 -1.76925 -0.0931468 0.560193 0.641963 0.199481 0.0131407 0.0256051 0.585661 0.946656 0.317466 0.723584  1.84540
##  56:     33416.886: -0.130928 0.524581 -1.78327 -0.0992058 0.564137 0.646786 0.206346 0.00609689 0.0184910 0.581290 0.945937 0.317624 0.736308  1.86256
##  57:     33416.140: -0.132769 0.523927 -1.78985 -0.0994944 0.564880 0.647348 0.202570 0.0115819 0.0256141 0.580964 0.946711 0.317958 0.741700  1.87011
##  58:     33415.804: -0.134945 0.523665 -1.79749 -0.0958054 0.564374 0.642907 0.201325 0.00940610 0.0231512 0.582949 0.948056 0.318748 0.747957  1.87880
##  59:     33415.517: -0.137368 0.522196 -1.80467 -0.0944678 0.562573 0.644304 0.201124 0.0116503 0.0262963 0.584372 0.949349 0.319441 0.754867  1.88863
##  60:     33415.271: -0.139899 0.519224 -1.81061 -0.0962206 0.561292 0.644512 0.201037 0.0108777 0.0227704 0.584072 0.948046 0.319665 0.761989  1.89909
##  61:     33415.004: -0.142759 0.516815 -1.81693 -0.0951407 0.564129 0.644672 0.200769 0.0113526 0.0256256 0.584185 0.947601 0.319990 0.768758  1.90968
##  62:     33414.761: -0.145583 0.515049 -1.82416 -0.0952283 0.562629 0.643008 0.201465 0.0100381 0.0234220 0.583748 0.948746 0.320406 0.775272  1.92020
##  63:     33414.542: -0.148467 0.511965 -1.82989 -0.0966932 0.561659 0.645144 0.201337 0.0119625 0.0256178 0.583234 0.948271 0.320627 0.781899  1.93110
##  64:     33414.321: -0.151656 0.509414 -1.83511 -0.0928180 0.563974 0.645369 0.200396 0.0108259 0.0224878 0.586048 0.947658 0.321388 0.787751  1.94162
##  65:     33414.087: -0.154774 0.507785 -1.84227 -0.0940196 0.563209 0.644708 0.200722 0.0103866 0.0258523 0.584381 0.948485 0.321924 0.793627  1.95230
##  66:     33413.911: -0.158008 0.504663 -1.84747 -0.0971528 0.562977 0.642646 0.201660 0.0112429 0.0229041 0.582514 0.948161 0.321573 0.799372  1.96333
##  67:     33413.691: -0.161688 0.501568 -1.85234 -0.0948430 0.562754 0.645631 0.201120 0.0110865 0.0247342 0.584865 0.948221 0.321911 0.804854  1.97472
##  68:     33413.503: -0.165417 0.499740 -1.85893 -0.0928463 0.563593 0.644413 0.200530 0.0114878 0.0219080 0.585195 0.948181 0.323724 0.810042  1.98588
##  69:     33413.285: -0.169182 0.497478 -1.86507 -0.0953892 0.563411 0.643669 0.200755 0.00992332 0.0248764 0.583550 0.948318 0.323852 0.814984  1.99717
##  70:     33413.157: -0.173318 0.495110 -1.87062 -0.0946343 0.564129 0.643768 0.202113 0.0136597 0.0233621 0.584121 0.948612 0.322239 0.819335  2.00881
##  71:     33412.928: -0.177324 0.492488 -1.87632 -0.0952845 0.561721 0.645344 0.201629 0.0108746 0.0227674 0.584855 0.948247 0.322830 0.824147  2.02036
##  72:     33412.795: -0.181476 0.490022 -1.88127 -0.0941248 0.564960 0.645171 0.200295 0.0128726 0.0257810 0.583956 0.947573 0.327220 0.828311  2.03121
##  73:     33412.558: -0.185833 0.488140 -1.88761 -0.0943894 0.564605 0.643149 0.200898 0.0110842 0.0233761 0.584142 0.948491 0.327907 0.832476  2.04284
##  74:     33412.400: -0.189970 0.486604 -1.89395 -0.0932749 0.563034 0.645398 0.201533 0.0119533 0.0254991 0.584680 0.948786 0.323844 0.836022  2.05408
##  75:     33412.214: -0.194303 0.483910 -1.89955 -0.0948246 0.563164 0.645467 0.201007 0.0121374 0.0229168 0.584269 0.947347 0.325731 0.840468  2.06582
##  76:     33412.057: -0.198639 0.482025 -1.90485 -0.0944735 0.564092 0.644324 0.201183 0.0107880 0.0255582 0.584678 0.948446 0.332215 0.844191  2.07637
##  77:     33411.898: -0.202970 0.480550 -1.91139 -0.0935179 0.564123 0.643485 0.201164 0.0120419 0.0238071 0.584552 0.949245 0.327805 0.847357  2.08777
##  78:     33411.758: -0.207432 0.477699 -1.91660 -0.0937191 0.563467 0.645903 0.200924 0.0110210 0.0248340 0.583905 0.947457 0.324993 0.850959  2.09969
##  79:     33411.625: -0.211572 0.474948 -1.92007 -0.0940163 0.563539 0.645481 0.201289 0.0120240 0.0232885 0.585045 0.947709 0.333902 0.854456  2.10952
##  80:     33411.489: -0.216398 0.473901 -1.92676 -0.0936233 0.563573 0.644260 0.200940 0.0107409 0.0254659 0.585351 0.949349 0.331144 0.856934  2.12119
##  81:     33411.368: -0.220938 0.471915 -1.93220 -0.0937422 0.564465 0.643806 0.200820 0.0119596 0.0238298 0.584004 0.948561 0.325457 0.859264  2.13261
##  82:     33411.250: -0.225535 0.468334 -1.93499 -0.0933649 0.563413 0.645777 0.201183 0.0110298 0.0245573 0.583929 0.947693 0.332978 0.862398  2.14332
##  83:     33411.126: -0.231128 0.466647 -1.94052 -0.0931201 0.564005 0.645109 0.200969 0.0121223 0.0232511 0.586134 0.948886 0.333388 0.864298  2.15563
##  84:     33411.009: -0.236452 0.464823 -1.94576 -0.0935760 0.564016 0.644875 0.200702 0.0109211 0.0249502 0.585166 0.948753 0.329335 0.865918  2.16772
##  85:     33410.910: -0.241749 0.461537 -1.94905 -0.0932443 0.563871 0.644429 0.201025 0.0119870 0.0233517 0.583465 0.947984 0.334838 0.868387  2.17941
##  86:     33410.523: -0.279468 0.448068 -1.97290 -0.0898310 0.563367 0.646238 0.200741 0.0149852 0.0252612 0.589257 0.956212 0.332807 0.872562  2.25468
##  87:     33410.063: -0.321145 0.432104 -1.98594 -0.0850476 0.566316 0.644337 0.196629 0.00845322 0.0244359 0.589584 0.954393 0.341249 0.870793  2.32987
##  88:     33409.867: -0.365557 0.425585 -1.99420 -0.103742 0.565831 0.642854 0.202227 0.0108960 0.0270830 0.577494 0.931994 0.359011 0.859726  2.39639
##  89:     33409.764: -0.415977 0.435233 -2.01156 -0.0989621 0.562959 0.640655 0.208719 0.0120761 0.0215660 0.580853 0.936365 0.346932 0.831181  2.45925
##  90:     33409.128: -0.465992 0.438348 -2.02826 -0.0896046 0.565948 0.647408 0.201611 0.0120632 0.0238730 0.581453 0.950134 0.371791 0.811031  2.52079
##  91:     33409.066: -0.466059 0.438577 -2.02892 -0.0911732 0.565463 0.646218 0.200041 0.00868171 0.0225309 0.584574 0.949425 0.371711 0.811247  2.52107
##  92:     33409.006: -0.468161 0.438087 -2.02990 -0.0909369 0.566072 0.646392 0.200252 0.0114764 0.0240113 0.584973 0.949218 0.370257 0.812047  2.52448
##  93:     33408.974: -0.470743 0.437187 -2.03079 -0.0907168 0.565420 0.645976 0.200272 0.0105037 0.0235737 0.585387 0.949194 0.368955 0.813237  2.52864
##  94:     33408.953: -0.473173 0.436678 -2.03247 -0.0905881 0.564901 0.645892 0.200380 0.0117193 0.0240240 0.585779 0.949101 0.367877 0.814548  2.53272
##  95:     33408.929: -0.475882 0.435749 -2.03347 -0.0905977 0.564666 0.645701 0.200261 0.0107780 0.0236356 0.585975 0.949232 0.366766 0.815626  2.53695
##  96:     33408.781: -0.523281 0.417010 -2.04532 -0.0900354 0.568743 0.644871 0.199067 0.0107565 0.0234362 0.586810 0.953304 0.352092 0.831168  2.60830
##  97:     33408.596: -0.574765 0.397656 -2.05336 -0.0846316 0.564957 0.643929 0.200117 0.00984478 0.0255994 0.589168 0.958682 0.362850 0.841883  2.67841
##  98:     33408.387: -0.634570 0.398869 -2.07006 -0.0818250 0.564183 0.647226 0.198470 0.0120080 0.0218985 0.591845 0.957664 0.377272 0.817880  2.73867
##  99:     33408.232: -0.691087 0.416478 -2.08958 -0.0866218 0.562603 0.646089 0.198238 0.0119282 0.0245659 0.590874 0.955901 0.376374 0.770714  2.78529
## 100:     33408.109: -0.746843 0.408664 -2.09374 -0.0881175 0.564144 0.644890 0.199875 0.0116913 0.0244095 0.589823 0.959823 0.388586 0.774097  2.85564
## 101:     33407.999: -0.801262 0.397869 -2.09712 -0.0849576 0.563792 0.646255 0.198623 0.00980916 0.0223194 0.588517 0.954045 0.386939 0.779569  2.92735
## 102:     33407.921: -0.853956 0.380645 -2.10177 -0.0840618 0.565168 0.647478 0.199094 0.0120657 0.0241827 0.590139 0.952168 0.387346 0.782710  2.99944
## 103:     33407.797: -0.958365 0.329875 -2.13572 -0.0828371 0.563580 0.645504 0.198378 0.0126774 0.0238708 0.591165 0.955161 0.395116 0.725148  3.14344
## 104:     33407.691: -1.06982 0.342508 -2.14144 -0.0845981 0.563317 0.648818 0.199856 0.0104880 0.0225216 0.590481 0.952771 0.409054 0.684808  3.29931
## 105:     33407.632: -1.10899 0.383616 -2.12927 -0.0831484 0.564241 0.645439 0.197984 0.0111160 0.0235974 0.591065 0.955477 0.416828 0.684066  3.36342
## 106:     33407.629: -1.11564 0.381681 -2.13128 -0.0855768 0.563851 0.646878 0.198523 0.0120175 0.0240090 0.589092 0.955656 0.415896 0.680618  3.37952
## 107:     33407.609: -1.12094 0.373909 -2.13692 -0.0859258 0.564152 0.646457 0.198822 0.0111968 0.0235075 0.589286 0.955134 0.418227 0.673443  3.39210
## 108:     33407.603: -1.12628 0.366992 -2.14181 -0.0859431 0.564593 0.646093 0.199098 0.0112941 0.0237020 0.589510 0.954736 0.420419 0.666796  3.40578
## 109:     33407.593: -1.14356 0.359621 -2.14304 -0.0862770 0.564313 0.645861 0.198930 0.0113389 0.0237471 0.589811 0.954505 0.423697 0.666087  3.45626
## 110:     33407.582: -1.16040 0.355076 -2.14883 -0.0857569 0.564396 0.645701 0.199056 0.0110598 0.0236932 0.589247 0.954825 0.425825 0.652038  3.50498
## 111:     33407.574: -1.17057 0.348187 -2.15488 -0.0862768 0.564348 0.645903 0.198953 0.0110882 0.0236419 0.589068 0.954580 0.430629 0.628407  3.55130
## 112:     33407.570: -1.18173 0.348596 -2.15689 -0.0862939 0.564231 0.645969 0.199092 0.0113201 0.0234617 0.589317 0.954467 0.431976 0.616106  3.60260
## 113:     33407.567: -1.18777 0.340774 -2.16311 -0.0856399 0.564152 0.645981 0.198977 0.0112180 0.0237809 0.589783 0.955244 0.436061 0.603916  3.65370
## 114:     33407.566: -1.18605 0.336144 -2.16587 -0.0859506 0.564453 0.646021 0.198927 0.0111617 0.0237165 0.589368 0.954806 0.436809 0.597770  3.67534
## 115:     33407.566: -1.18342 0.338242 -2.16421 -0.0859896 0.564207 0.646037 0.198935 0.0112399 0.0236176 0.589434 0.954886 0.438728 0.589822  3.69675
## 116:     33407.566: -1.18066 0.337686 -2.16519 -0.0860470 0.564253 0.646033 0.198956 0.0112283 0.0236450 0.589414 0.954833 0.438146 0.592672  3.69202
## 117:     33407.566: -1.17997 0.338183 -2.16452 -0.0859890 0.564292 0.646026 0.198945 0.0112172 0.0236574 0.589431 0.954853 0.438127 0.592037  3.69260
## 118:     33407.566: -1.17949 0.337930 -2.16479 -0.0859945 0.564271 0.646033 0.198943 0.0112249 0.0236473 0.589429 0.954853 0.438195 0.592209  3.69255
## Warning: 5 external pointers will be removed
## Step 3 -fit model-: 75.553 sec elapsed
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-4-1.png)

```
## Step 4 -plot graphs-: 0.514 sec elapsed
## run main.R: 95.083 sec elapsed
```

```r
# Move ThinkR second execution in the temp folder
dir.create(file.path(tmp_folder, "thinkr_output_rerun"))
fs::file_move(
  path = list.files(
    path = output_dir,
    full.names = TRUE
  ),
  new_path = file.path(tmp_folder, "thinkr_output_rerun")
)
```
We list the resulting output files.


```r
thinkr1_output_dir <- file.path(tmp_folder, "thinkr_output")

thinkr1_output <- paste0(
  list.files(
    path = thinkr1_output_dir,
    full.names = TRUE
  ),
  collapse = "\n"
)

glue::glue("The paths to ThinkR's second run output files are :\n {thinkr1_output}")
```

```
## The paths to ThinkR's second run output files are :
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/thinkr_output/converge_output.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/thinkr_output/obj_input.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/thinkr_output/opt_output.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/thinkr_output/report_output.rds
```

```r
thinkr2_output_dir <- file.path(tmp_folder, "thinkr_output_rerun")

thinkr2_output <- paste0(
  list.files(
    path = thinkr2_output_dir,
    full.names = TRUE
  ),
  collapse = "\n"
)

glue::glue("The paths to ThinkR's first run output files are :\n {thinkr2_output}")
```

```
## The paths to ThinkR's first run output files are :
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/thinkr_output_rerun/converge_output.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/thinkr_output_rerun/obj_input.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/thinkr_output_rerun/opt_output.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/thinkr_output_rerun/report_output.rds
```

## Checking seed reproducibility

In order to contrast output files from both ThinkR runs, we will use the package `{waldo}`.


```r
# list of output fiiles to contrast
files_to_contrast <- list.files(path = file.path(thinkr1_output_dir))

# running waldo on each files comparing thinkR runs
purrr::map(
  .x = files_to_contrast,
  ~ waldo::compare(
    x = readRDS(
      file.path(thinkr1_output_dir, .x)
    ),
    y = readRDS(
      file.path(thinkr2_output_dir, .x)
    )
  )
) %>% setNames(files_to_contrast)
```

```
## $converge_output.rds
## ✔ No differences
## 
## $obj_input.rds
## ✔ No differences
## 
## $opt_output.rds
## ✔ No differences
## 
## $report_output.rds
## ✔ No differences
```
Both ThinkR outputs are identical. We will use one of them to now compare with the Client's output.

## Loading Client's output

We now load the outputs generated from Clients (BA and JC) in a temporary folder.


```r
# Download and unzip JC outputs from Git repo
jc_zip_file_url <- "https://github.com/balglave/FishMap/files/10897028/outputs_fishmap.zip"
download.file(
  url = jc_zip_file_url,
  destfile = file.path(tmp_folder, "jc_output.zip")
)

unzip(
  zipfile = file.path(tmp_folder, "jc_output.zip"),
  exdir = file.path(tmp_folder, "jc_output")
)

jc_output_dir <- file.path(tmp_folder, "jc_output")

jc_output <- paste0(
  list.files(
    path = jc_output_dir,
    full.names = TRUE
  ),
  collapse = "\n"
)

glue::glue("The paths to Juliette's output files are :\n {jc_output}")
```

```
## The paths to Juliette's output files are :
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/jc_output/converge_output.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/jc_output/obj_input.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/jc_output/opt_output.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/jc_output/report_output.rds
```

```r
# Download and unzip BA outputs from Git repo
ba_zip_file_url <- "https://github.com/balglave/FishMap/files/10912068/shared.zip"
download.file(
  url = ba_zip_file_url,
  destfile = file.path(tmp_folder, "ba_output.zip")
)

unzip(
  zipfile = file.path(tmp_folder, "ba_output.zip"),
  exdir = file.path(tmp_folder, "ba_output")
)

ba_output_dir <- file.path(tmp_folder, "ba_output", "shared", "outputs_fishmap")

ba_output <- paste0(
  list.files(
    path = ba_output_dir,
    full.names = TRUE
  ),
  collapse = "\n"
)

glue::glue("The paths to Baptiste's output files are :\n {ba_output}")
```

```
## The paths to Baptiste's output files are :
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/ba_output/shared/outputs_fishmap/converge_output.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/ba_output/shared/outputs_fishmap/obj_input.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/ba_output/shared/outputs_fishmap/opt_output.rds
## /tmp/Rtmp8Njh1h/fishmap_check6ef8555d69e7/ba_output/shared/outputs_fishmap/report_output.rds
```


## Contrasting files

Results between ThinkR and Client's are not perfectly identical. 

**Important note** : To compare numerical results we will set a tolerance in numerical differences to **10e-6**.

We find differences in function code present in the outputs (see section on `obj_inputs.rds`). This might indicate a difference in **package version**. Could you please indicate the `R` and `TMB` package version you used for generating the outputs ?

### Create contrast function

We will use again `{waldo}` within a function to display the exact differences for each file.


```r
# Create a function to explore waldo's output file by file between ThinkR and Baptiste + Juliette outputs

compare_output_file <- function(file_name, author) {
  if (author == "juliette") {
    client_output_dir <- jc_output_dir
  } else if (author == "baptiste") {
    client_output_dir <- ba_output_dir
  } else {
    stop("author must be either juliette or baptiste")
  }

  # running waldo on one file (thinkR ~ juliette)
  message(glue::glue("contrasting output of {file_name} between thinkr and {author}"))
  compare_author <- waldo::compare(
    x = readRDS(
      file.path(client_output_dir, file_name)
    ),
    y = readRDS(
      file.path(thinkr1_output_dir, file_name)
    ),
    x_arg = author,
    y_arg = "thinkr",
    # max_diffs = Inf,
    tolerance = 10e-6
  )

  return(compare_author)
}
```

### Contrasting `converge_output.rds` output


```r
compare_output_file(file_name = "converge_output.rds", author = "baptiste")
```

```
## contrasting output of converge_output.rds between thinkr and baptiste
```

```
## ✔ No differences
```

```r
compare_output_file(file_name = "converge_output.rds", author = "juliette")
```

```
## contrasting output of converge_output.rds between thinkr and juliette
```

```
## ✔ No differences
```

### Contrasting `opt_output.rds` output


```r
compare_output_file(file_name = "opt_output.rds", author = "baptiste")
```

```
## contrasting output of opt_output.rds between thinkr and baptiste
```

```
## `baptiste$par`: -1.9490 0.2168 -2.5303 -0.0850 0.5574 0.6502 0.1979 0.0129 0.0233 0.5913 and 4 more...
##   `thinkr$par`: -1.1795 0.3379 -2.1648 -0.0860 0.5643 0.6460 0.1989 0.0112 0.0236 0.5894           ...
## 
## `baptiste$objective`: 33456
##   `thinkr$objective`: 33408
## 
## `baptiste$iterations`:  90
##   `thinkr$iterations`: 118
## 
## `baptiste$evaluations`: 107  91
##   `thinkr$evaluations`: 135 119
## 
## baptiste$diagnostics vs thinkr$diagnostics
##                                      Est      gradient
## - baptiste$diagnostics[1, ]  -1.94904960 -0.0001187346
## + thinkr$diagnostics[1, ]    -1.17949342 -0.0001561867
## - baptiste$diagnostics[2, ]   0.21680213 -0.0018261458
## + thinkr$diagnostics[2, ]     0.33792979 -0.0010848019
## - baptiste$diagnostics[3, ]  -2.53032471  0.0029264548
## + thinkr$diagnostics[3, ]    -2.16478513  0.0006139109
## - baptiste$diagnostics[4, ]  -0.08504909  0.0079738797
## + thinkr$diagnostics[4, ]    -0.08599450  0.0146084507
## - baptiste$diagnostics[5, ]   0.55737355  0.0139231033
## + thinkr$diagnostics[5, ]     0.56427059  0.0036463891
## - baptiste$diagnostics[6, ]   0.65017746 -0.0300420653
## + thinkr$diagnostics[6, ]     0.64603308 -0.0029672675
## - baptiste$diagnostics[7, ]   0.19788364 -0.0177909561
## + thinkr$diagnostics[7, ]     0.19894322 -0.0051335908
## - baptiste$diagnostics[8, ]   0.01287220  0.0366791776
## + thinkr$diagnostics[8, ]     0.01122493  0.0208665077
## - baptiste$diagnostics[9, ]   0.02332747 -0.0964211843
## + thinkr$diagnostics[9, ]     0.02364726 -0.0177326826
## - baptiste$diagnostics[10, ]  0.59125481 -0.0178599756
## + thinkr$diagnostics[10, ]    0.58942941 -0.0045798545
## and 4 more ...
## 
## `baptiste$diagnostics$Est`: -1.9490 0.2168 -2.5303 -0.0850 0.5574 0.6502 0.1979 0.0129 0.0233 0.5913 and 4 more...
##   `thinkr$diagnostics$Est`: -1.1795 0.3379 -2.1648 -0.0860 0.5643 0.6460 0.1989 0.0112 0.0236 0.5894           ...
## 
##      baptiste$diagnostics$gradient | thinkr$diagnostics$gradient               
##  [1] -0.00012                      - -0.00016                    [1]           
##  [2] -0.00183                      - -0.00108                    [2]           
##  [3] 0.00293                       - 0.00061                     [3]           
##  [4] 0.00797                       - 0.01461                     [4]           
##  [5] 0.01392                       - 0.00365                     [5]           
##  [6] -0.03004                      - -0.00297                    [6]           
##  [7] -0.01779                      - -0.00513                    [7]           
##  [8] 0.03668                       - 0.02087                     [8]           
##  [9] -0.09642                      - -0.01773                    [9]           
## [10] -0.01786                      - -0.00458                    [10]          
##  ... ...                             ...                         and 4 more ...
```

```r
compare_output_file(file_name = "opt_output.rds", author = "juliette")
```

```
## contrasting output of opt_output.rds between thinkr and juliette
```

```
## juliette$diagnostics vs thinkr$diagnostics
##                                   gradient
## - juliette$diagnostics[1, ]  -0.0001563852
## + thinkr$diagnostics[1, ]    -0.0001561867
## - juliette$diagnostics[2, ]  -0.0010823369
## + thinkr$diagnostics[2, ]    -0.0010848019
## - juliette$diagnostics[3, ]   0.0006077771
## + thinkr$diagnostics[3, ]     0.0006139109
## - juliette$diagnostics[4, ]   0.0145954406
## + thinkr$diagnostics[4, ]     0.0146084507
## - juliette$diagnostics[5, ]   0.0036414382
## + thinkr$diagnostics[5, ]     0.0036463891
## - juliette$diagnostics[6, ]  -0.0029317417
## + thinkr$diagnostics[6, ]    -0.0029672675
## - juliette$diagnostics[7, ]  -0.0051173286
## + thinkr$diagnostics[7, ]    -0.0051335908
## - juliette$diagnostics[8, ]   0.0208625464
## + thinkr$diagnostics[8, ]     0.0208665077
## - juliette$diagnostics[9, ]  -0.0176931908
## + thinkr$diagnostics[9, ]    -0.0177326826
## - juliette$diagnostics[10, ] -0.0045711599
## + thinkr$diagnostics[10, ]   -0.0045798545
## and 4 more ...
## 
##      juliette$diagnostics$gradient | thinkr$diagnostics$gradient               
##  [1] -0.0001564                    - -0.0001562                  [1]           
##  [2] -0.0010823                    - -0.0010848                  [2]           
##  [3] 0.0006078                     - 0.0006139                   [3]           
##  [4] 0.0145954                     - 0.0146085                   [4]           
##  [5] 0.0036414                     - 0.0036464                   [5]           
##  [6] -0.0029317                    - -0.0029673                  [6]           
##  [7] -0.0051173                    - -0.0051336                  [7]           
##  [8] 0.0208625                     - 0.0208665                   [8]           
##  [9] -0.0176932                    - -0.0177327                  [9]           
## [10] -0.0045712                    - -0.0045799                  [10]          
##  ... ...                             ...                         and 4 more ...
```

### Contrasting `report_output.rds` output


```r
compare_output_file(file_name = "report_output.rds", author = "baptiste")
```

```
## contrasting output of report_output.rds between thinkr and baptiste
```

```
## `baptiste$Sigma_sci`: 1.56
##   `thinkr$Sigma_sci`: 1.55
## 
##      baptiste$E_com | thinkr$E_com                   
##  [1] 1.3577841      - 1.1792888    [1]               
##  [2] 1.0008861      - 1.1848715    [2]               
##  [3] 0.8226959      - 0.7103972    [3]               
##  [4] 0.8709679      - 0.7517946    [4]               
##  [5] 0.9220722      - 0.7956044    [5]               
##  [6] 0.9220722      - 0.7956044    [6]               
##  [7] 1.0028563      - 0.8950327    [7]               
##  [8] 1.0028563      - 0.8950327    [8]               
##  [9] 1.2077563      - 1.1797381    [9]               
## [10] 1.3098958      - 1.3225070    [10]              
##  ... ...              ...          and 26774 more ...
## 
## `baptiste$S_com_i`: 1.35778 1.00089 0.82270 0.87097 0.92207 0.92207 1.00286 1.00286 1.20776 1.30990 and 26774 more...
##   `thinkr$S_com_i`: 1.17929 1.18487 0.71040 0.75179 0.79560 0.79560 0.89503 0.89503 1.17974 1.32251               ...
## 
## `baptiste$Sigma_com`: 1.2188 1.0130 1.0236
##   `thinkr$Sigma_com`: 1.2201 1.0113 1.0239
## 
## `dim(baptiste$delta_x)`: 116 1
##   `dim(thinkr$delta_x)`: 110 1
## 
## `baptiste$delta_x[108:116]`: 0 0 0 0 0 0 0 0 0
##   `thinkr$delta_x[108:110]`: 0 0 0            
## 
## `baptiste$epsilon_com_i[1:1247]`: 2.25 1.95 1.75 1.81 1.87 1.87 1.95 1.95 2.14 2.22 and 1237 more...
##   `thinkr$epsilon_com_i[1:1224]`: 1.34 1.35 0.84 0.89 0.95 0.95 1.07 1.07 1.34 1.46              ...
## 
## `baptiste$epsilon_com_i[1254:11193]`: -1.09 -1.09 -1.09  0.87  1.00  1.00  0.93  0.93  0.90  0.90 and 9930 more...
##   `thinkr$epsilon_com_i[1231:11170]`: -1.09 -1.09 -1.09 -1.09 -1.09 -1.09 -1.09 -1.09 -1.09 -1.09              ...
## 
## `baptiste$epsilon_com_i[11199:13544]`: 0.95 0.95 0.95 0.09 0.09 0.09 0.99 0.23 0.23 0.12 and 2337 more...
##   `thinkr$epsilon_com_i[11176:13522]`: 0.95 0.95 0.95 0.95 0.50 0.50 0.50 0.50 0.50 0.50              ...
## 
## `baptiste$epsilon_com_i[13545:26784]`: 1.85 1.85 1.85 1.85 1.85 1.85 1.80 1.80 1.80 1.80 and 13253 more...
##   `thinkr$epsilon_com_i[13523:26784]`: 1.85 1.85 1.85 1.15 1.15 1.11 1.11 1.22 1.22 1.21               ...
## 
## And 21 more differences ...
```

```r
compare_output_file(file_name = "report_output.rds", author = "juliette")
```

```
## contrasting output of report_output.rds between thinkr and juliette
```

```
## ✔ No differences
```

### Contrasting `obj_input.rds` output



```r
compare_output_file(file_name = "obj_input.rds", author = "juliette")
```

```
## contrasting output of obj_input.rds between thinkr and juliette
```

```
##     body(environment(juliette$fn)$dataSanitize)                | body(environment(thinkr$fn)$dataSanitize)    
## [2] `    if (is.list(x)) `                                     | `    if (is.list(x)) `                    [2]
## [3] `        return(lapply(x, dataSanitize))`                  | `        return(lapply(x, dataSanitize))` [3]
## [4] `    if (is(x, "sparseMatrix")) {`                         | `    if (is(x, "sparseMatrix")) {`        [4]
## [5] `        x <- as(as(x, "TsparseMatrix"), "generalMatrix")` - `        x <- as(x, "dgTMatrix")`         [5]
## [6] `    }`                                                    | `    }`                                   [6]
## [7] `    else if (is.character(x)) {`                          | `    else if (is.character(x)) {`         [7]
## [8] `    }`                                                    | `    }`                                   [8]
```

We encounter an error when contrasting the `fn` element of the `obj_input.rds` object between Baptiste's version and ThinkR's version. We run `{waldo}` with a specific parameter (`ignore_function_env = TRUE`) that ignore function environment comparison and allows the comparison to succeed. This error might come from a difference in package version (cf. comment at the beginning of section).


```r
file_name <- "obj_input.rds"
author <- "baptiste"
client_output_dir <- ba_output_dir

message(glue::glue("contrasting output of {file_name} between thinkr and {author}"))
```

```
## contrasting output of obj_input.rds between thinkr and baptiste
```

```r
compare_baptiste <- waldo::compare(
  x = readRDS(
    file.path(client_output_dir, file_name)
  ),
  y = readRDS(
    file.path(thinkr1_output_dir, file_name)
  ),
  x_arg = author,
  y_arg = "thinkr",
  # max_diffs = Inf,
  tolerance = 10e-6,
  ignore_function_env = TRUE # add this parameter to allow comparison without error
)
```

```
## Error: Variables must be length 1 or 36
```

```r
compare_baptiste
```

```
## Error in eval(expr, envir, enclos): object 'compare_baptiste' not found
```


```r
# delete temporary folder
unlink(tmp_folder)
```



```r
# knit the Rmd as a compiled Rmd in vignettes
knitr::knit(
  input = here::here("dev/dev_check_model_reproducibility.Rmd"),
  output = here::here("vignettes/check_model_reproducibility.Rmd")
)
```

```
## 
## 
## processing file: /home/rstudio/FishMap/dev/dev_check_model_reproducibility.Rmd
```

```
## Error in parse_block(g[-1], g[1], params.src, markdown_mode): Duplicate chunk label 'setup', which has been used for the chunk:
## knitr::opts_chunk$set(echo = TRUE)
```

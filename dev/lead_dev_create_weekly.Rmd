---
title: "Create Weekly with GitHub or GitLab"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ac-create-weekly-with-github-or-gitlab}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(lozen)
```

<!-- WARNING - This vignette is generated by {fusen} from dev/flat_create_weekly.Rmd: do not edit by hand -->

```{r message = FALSE}
library(gh)
library(dplyr)
library(purrr)
library(tidyr)
library(glue)
library(stringr)
library(stringi)
library(forcats)
library(ggplot2)
library(scales)
library(gitlabr)
library(lubridate)
```

# Create a weekly for GitHub with `gh_create_weekly()` (old board)

    

  

```{r example-gh_create_weekly}
if (Sys.getenv("GITHUB_PAT") != "") {
  user <- "ThinkR-open"
  repo <- "example-weekly"
weekly <- gh_create_weekly(
  date_min = "2022-06-30",
  date_max = "2022-06-30",
  user = user,
  repo = repo,
  board_url = glue::glue("/repos/{user}/{repo}/projects")
)
}
# Copier dans le presse papier pour copier directement
# clipr::write_clip(weekly$weekly_info)
```

  

  

# Create a weekly for GitHub with `gh_create_weekly_new_projects_board()` (new board)    

## Query GraphQL Github API

This functions allow querying the last version of the Github API to retrieve the status of the project board.

By default, it uses the `GITHUB_PAT` environment variable. Please ensure that the read:project scope is provided with your token.

Please visit the [API documentation] (https://docs.github.com/en/issues/planning-and-tracking-with-projects/automating-your-project/using-the-api-to-manage-projects?tool=cli#finding-information-about-items-in-a-project) to generate a token with such privileges.



  

```{r example-graphql_to_tibble}
board_url <- "https://github.com/orgs/ThinkR-open/projects/4/" 
github_token <- Sys.getenv("GITHUB_PAT")

graphql_to_tibble(board_url = "https://github.com/orgs/ThinkR-open/projects/4/",
                  github_token = github_token)
```

  
 

```{r example-gh_create_weekly_new_projects_board}
board_url <- "https://github.com/orgs/ThinkR-open/projects/4/" 
date_min <- "2022-06-30"
date_max <- "2022-06-30"
user <- "ThinkR-open"
repo <- "example-weekly"

if(Sys.getenv("GITHUB_PAT") != "") {
  
  weekly <- gh_create_weekly_new_projects_board(date_min = date_min,
                                                date_max = date_max,
                                                user = user,
                                                repo = repo,
                                                board_url = board_url,
                                                github_token = Sys.getenv("GITHUB_PAT"),
                                                verbose = FALSE)
}

# Copier dans le presse papier pour copier directement
# clipr::write_clip(weekly$weekly_info)
```

  

  

# Visualise the nature of the developments `visualise_commits()`

 
Only the main branch is considered.
  

```{r example-visualise_commits}
 
  visualise_commits(path = tempdir,
                    date_min = "2022-09-22",
                    date_max = "2022-09-29")
```



  

  



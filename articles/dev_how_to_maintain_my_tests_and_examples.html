<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dev - How to maintain my tests and-examples • FishMap</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dev - How to maintain my tests and-examples">
<meta property="og:description" content="FishMap">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FishMap</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dev-check-model-reproducibility-highres-same-pkg-version.html">dev - check high resolution model reproducibility with same package version</a>
    </li>
    <li>
      <a href="../articles/dev-check-model-reproducibility-highres.html">dev - check high resolution model reproducibility</a>
    </li>
    <li>
      <a href="../articles/dev-check-model-reproducibility-lowres.html">dev - check low resolution model reproducibility</a>
    </li>
    <li>
      <a href="../articles/dev-execute-main.html">dev - execute main</a>
    </li>
    <li>
      <a href="../articles/dev-fit-model.html">Dev - Fit Model</a>
    </li>
    <li>
      <a href="../articles/dev-generate-graphs.html">Dev - Generate Graphs</a>
    </li>
    <li>
      <a href="../articles/dev-load-data.html">Dev - Load Data</a>
    </li>
    <li>
      <a href="../articles/dev_how_to_maintain_my_tests_and_examples.html">Dev - How to maintain my tests and-examples</a>
    </li>
    <li>
      <a href="../articles/user-running-fishmap.html">user - running fishmap</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dev - How to maintain my tests and-examples</h1>
            
      
      
      <div class="hidden name"><code>dev_how_to_maintain_my_tests_and_examples.Rmd</code></div>

    </div>

    
    
<p>The tests and examples in this package are based on the outputs of
the various functions in the package. For example, the
<code>fm_fit_model</code> function needs the output of the
<code>fm_load_data</code> function. One could, for each example or test,
run the <code>fm_load_data</code> function upstream to retrieve the
outputs and run <code>fm_fit_model</code>. The problem is that these
functions take a long time to run and so we prefer to store the output
of each function for later use.</p>
<p>There are two benefits to this solution:</p>
<ul>
<li>Examples and tests are faster (time saving in CI and check)</li>
<li>Outputs can be compared with the output of the functions in the unit
tests to ensure that the package works.</li>
</ul>
<p>Two models can be distinguished, a model with little data, which we
will call “small”, and a model with a lot of data, which we will call
“big”. These two models oblige us to have different strategies depending
on the model.</p>
<p>We will detail :</p>
<ul>
<li>Where these results are stored</li>
<li>How these results are stored</li>
<li>Explain the problem with the version of the packages for INLA and
TMB and the possible consequences on the test results</li>
</ul>
<div class="section level2">
<h2 id="where-to-store-these-results">Where to store these results<a class="anchor" aria-label="anchor" href="#where-to-store-these-results"></a>
</h2>
<div class="section level3">
<h3 id="the-small-model">The ‘small’ model<a class="anchor" aria-label="anchor" href="#the-small-model"></a>
</h3>
<p>We have chosen to store the results of the functions in the
<code>inst/examples</code> folder. This allows the outputs to be reused
in the examples. The content of this <code>inst/</code> folder is
accessible at the root directory of <code>FishMap</code>, once the
package is installed or after running the following code inside the
FishMap project (it simulates the installation of FishMap) :</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pkgload</span><span class="fu">::</span><span class="fu"><a href="https://pkgload.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>On ce FishMap is installed, you can access the files with the
following code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fm_data_inputs</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"part1_output_small.rds"</span>, package <span class="op">=</span> <span class="st">"FishMap"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>These outputs are also reused in tests in the same way.</p>
</div>
<div class="section level3">
<h3 id="the-big-model">The “big” model<a class="anchor" aria-label="anchor" href="#the-big-model"></a>
</h3>
<p>The function examples are not based on this model and so the data
will not be stored in <code>examples</code>.</p>
<p>The results of the model are larger, so only part of it will be
stored in <code>tests/testthat</code> for unit testing. See the section
on how.</p>
</div>
</div>
<div class="section level2">
<h2 id="how-these-results-are-stored">How these results are stored<a class="anchor" aria-label="anchor" href="#how-these-results-are-stored"></a>
</h2>
<p>The strategy for how data is stored is not the same depending on the
model. Nevertheless, they are based on the same principle. Two
environment variables are defined, each with a specific purpose.</p>
<ul>
<li><p>The environment variable “FISHMAP_TEST_RESOLUTION” can take two
values “small” or “big”. By default, the value is “small”. You will need
to explicitly set the value to “big” in a <code>.Renviron</code> file.
This variable allows unit tests to be run under the right conditions for
the chosen model.</p></li>
<li><p>The “FISHMAP_UPDATE_TEST_OUTPUTS” environment variable is used to
update the outputs to be tested. If its value is “TRUE” then the outputs
will be replaced and everything else will remain the same.</p></li>
</ul>
<p>We will therefore detail how this works for both models.</p>
<div class="section level3">
<h3 id="the-small-model-1">The “small” model<a class="anchor" aria-label="anchor" href="#the-small-model-1"></a>
</h3>
<p>By default, unit tests are run with this model. They read the results
of the necessary functions and execute only the function to be tested.
Here is a simplified example of a test implementation for the
<code>fm_fit_model</code> function (you can find the full example in
<code>tests/testthat/test-fm_fit_model.R</code>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Testing for small model</span></span>
<span>  </span>
<span><span class="va">test_resolution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"FISHMAP_TEST_RESOLUTION"</span>, unset <span class="op">=</span> <span class="st">"small"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">test_resolution</span> <span class="op">==</span> <span class="st">"small"</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">expected_outputs</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>        <span class="st">"examples"</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"part2_output_"</span>, <span class="va">test_resolution</span> , <span class="st">".rds"</span><span class="op">)</span>,</span>
<span>        package <span class="op">=</span> <span class="st">"FishMap"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="co">#' @description Testing that the result of `fm_fit_model` is stable</span></span>
<span>    <span class="fu">expect_equal</span><span class="op">(</span></span>
<span>      object <span class="op">=</span> <span class="va">expected_result</span>,</span>
<span>      expected <span class="op">=</span> <span class="va">expected_outputs</span>,</span>
<span>      tolerance <span class="op">=</span> <span class="fl">10e-6</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span></code></pre></div>
<p>Explanation of what the code does:</p>
<ul>
<li>It looks at which conditon we should run the test in, model “small”
or “big”.</li>
<li>It reads the outputs of the correct model</li>
<li>It compares the new or old results to make sure we have the same
results as before the changes.</li>
</ul>
<p>Here is another example using the output of the
<code>fm_load_data</code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="va">test_resolution</span> <span class="op">==</span> <span class="st">"small"</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">fm_data_inputs</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"part1_output_small.rds"</span>, package <span class="op">=</span> <span class="st">"FishMap"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span><span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">test_resolution</span> <span class="op">==</span> <span class="st">"big"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## TODO use correct params for line below</span></span>
<span>  <span class="co"># fm_data_inputs &lt;- fm_load_data(k = 0.75, month_start = 10, month_end = 12, ...)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># run part2</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>,<span class="op">{</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">fm_model_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fm_fit_model.html">fm_fit_model</a></span><span class="op">(</span>fm_data_inputs <span class="op">=</span> <span class="va">fm_data_inputs</span>,</span>
<span>                                   SE <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                   data_source <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                   data_obs <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                   samp_process <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                   b_constraint <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                   cov_samp_process <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                   biomass_temporal <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                   sampling_temporal <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                   lf_link <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                   ref_data <span class="op">=</span> <span class="st">"com"</span>,</span>
<span>                                   EM <span class="op">=</span> <span class="st">"est_b"</span>,</span>
<span>                                   month_ref <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Code explanation:</p>
<ul>
<li>Since we are in “small”, we read the saved results from the
<code>fm_load_data</code> function</li>
<li>We run the model to be able to compare it later</li>
</ul>
</div>
<div class="section level3">
<h3 id="the-big-model-1">The “big” model<a class="anchor" aria-label="anchor" href="#the-big-model-1"></a>
</h3>
<p><strong>The unit tests for the “big” model are not yet implemented.
So, this is not possible to show a example.</strong></p>
<p>Due to the amount of data, only some of it will need to be stored in
the <code>tests/testthat</code> folder as this will only be used for
testing.</p>
<p>Find more information about what we will have to check for the big
model on this <a href="https://github.com/balglave/FishMap/issues/47#issuecomment-1470406550" class="external-link">comment</a></p>
</div>
<div class="section level3">
<h3 id="updating-outputs">Updating outputs<a class="anchor" aria-label="anchor" href="#updating-outputs"></a>
</h3>
<p>As a dev, you will need to update the outputs if the functions or
dependent packages change.</p>
<blockquote>
<p>When you launch your tests and if you decide to update the outputs.
The comparison of the results, by definition, will always be ok because
the output read corresponds to the output you just created.</p>
</blockquote>
<p>To do this, in each function, the unit tests allow you to update the
outputs thanks to the modification of an environment variable named
<code>FISHMAP_UPDATE_TEST_OUTPUTS</code>. In the code of unit tests, you
will see code as follows :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Update expected outputs here</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"FISHMAP_UPDATE_TEST_OUTPUTS"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># save output depending if we are in flat or in test</span></span>
<span>  <span class="va">output_inst_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"inst"</span>, <span class="st">"examples"</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">test_resolution</span> <span class="op">==</span> <span class="st">"small"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">write_rds</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fm_model_results</span>,</span>
<span>                     file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_inst_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"part2_output_"</span>, <span class="va">test_resolution</span> , <span class="st">".rds"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">test_resolution</span> <span class="op">==</span> <span class="st">"big"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">## TODO what we need to check</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># check output is saved as rds</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"FISHMAP_UPDATE_TEST_OUTPUTS"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">output_inst_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"inst"</span>, <span class="st">"examples"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#' @description Test to check if we can save output</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_inst_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"part2_output_"</span>, <span class="va">test_resolution</span> , <span class="st">".rds"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Code explanation:</p>
<ul>
<li>The first part updates the rds file output in the “inst/examples”
directory.</li>
<li>The second part verify that the file really exists.</li>
</ul>
<p>To update all example &amp; tests files in your package following a
change in functions code, or package version, here is the procedure to
follow:</p>
<ul>
<li>Modify your <code>.Renviron</code> (you can access it with
<code>usethis::edit_r_environ()</code>) to add the following line:</li>
</ul>
<pre><code><span><span class="va">FISHMAP_UPDATE_TEST_OUTPUTS</span><span class="op">=</span><span class="cn">TRUE</span></span></code></pre>
<ul>
<li>Restart your R session. You can verify your <code>.Renviron</code>
variable has been correctly set with the command
<code>Sys.getenv("FISHMAP_UPDATE_TEST_OUTPUTS")</code>. It should return
<code>TRUE</code> now.</li>
<li>Run the unit tests once. Errors may occur due to the order of the
unit tests. At this stage, this is not serious.</li>
</ul>
<p>You can run the unit tests from the command line using the
<a href="https://devtools.r-lib.org/" class="external-link">devtools</a> package with the following command:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>You should see that the output files in <code>inst/examples</code>
have been updated.</li>
<li>Restart your R session having changed the .Renviron to :</li>
</ul>
<pre><code><span><span class="va">FISHMAP_UPDATE_TEST_OUTPUTS</span><span class="op">=</span><span class="cn">FALSE</span></span></code></pre>
<ul>
<li>You can verify your <code>.Renviron</code> variable has been
correctly reset with the command
<code>Sys.getenv("FISHMAP_UPDATE_TEST_OUTPUTS")</code>. It should return
<code>FALSE</code> now.</li>
<li>Run the unit tests again. There should be no more errors. If this is
the case, then changes in your code have not been taken into
account.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="if-you-have-a-problem-with-the-version-of-the-package-for-inla-and-tmb-and-the-possible-consequences-for-the-test-results">If you have a problem with the version of the package for INLA and
TMB and the possible consequences for the test results<a class="anchor" aria-label="anchor" href="#if-you-have-a-problem-with-the-version-of-the-package-for-inla-and-tmb-and-the-possible-consequences-for-the-test-results"></a>
</h2>
<blockquote>
<p>While developing the package, we noticed significant differences
between the INLA and TMB package versions.</p>
</blockquote>
<p>To overcome the problem of the INLA and TMB package versions, we
invite you to keep the <code>DESCRIPTION</code> file up to date. This
file allows you to know which package version is used by the developers.
It should evolve over time and versions are not meant to be static.</p>
<p>If unit tests don’t pass because of differences in results, make sure
you have the correct package versions for INLA and TMB. You can find the
information on minimal version required in the <code>DESCRIPTION</code>
file with the lines <code>Config/FishMap/INLA/version</code> and
<code>Config/FishMap/TMB/version</code>. You can find your current
package version with the commands <code>packageVersion("TMB")</code> and
<code>packageVersion("INLA")</code>.</p>
<p>Here is the code to update if needed:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">desc_file</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"DESCRIPTION"</span><span class="op">)</span></span>
<span>  <span class="va">version_inla</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"INLA"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">version_tmb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"TMB"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">the_desc</span> <span class="op">&lt;-</span> <span class="fu">desc</span><span class="fu">::</span><span class="fu"><a href="http://r-lib.github.io/desc/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">desc_file</span><span class="op">)</span></span>
<span>  <span class="va">the_desc</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>`Config/FishMap/INLA/version` <span class="op">=</span> <span class="va">version_inla</span><span class="op">)</span></span>
<span>  <span class="va">the_desc</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>`Config/FishMap/TMB/version` <span class="op">=</span> <span class="va">version_tmb</span><span class="op">)</span></span>
<span>  <span class="va">the_desc</span><span class="op">$</span><span class="fu">write</span><span class="op">(</span>file <span class="op">=</span> <span class="va">desc_file</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Baptiste Alglave, Sebastien Rochette, Swann Floc’hlay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
